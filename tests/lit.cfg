import os
import os.path
import sys
import lit
import lit.formats


config.name = 'Moonshot'
config.suffixes = ['.fox']
config.test_format = lit.formats.ShTest(execute_external=False)
config.test_source_root = os.path.dirname(__file__)

bin_path = lit_config.params.get('fox_bin', None)
if bin_path:
  print('Fox bin dir:' + bin_path)
else:
  lit_config.error("Fox bin dir not found")

# Create the full binary path
bin_path = os.path.join(bin_path, 'Moonshot')
fox_base_subst = bin_path + ' %s'

# Note: The order of append here is important, because items added first
# are considered by LIT first. 
#
# For instance, if %fox was at the top of the list any subst beginning 
# with %fox wouldn't be considered.
#
# So, the rule of thumb is to add the shortest substitutions at the end
# of the list, and the longest, most complete ones at the top of the
# list.
config.substitutions.append(
    ('%fox-verify-soft', (fox_base_subst + ' -verify-soft')))
config.substitutions.append(
    ('%fox-verify', (fox_base_subst + ' -verify')))
config.substitutions.append(('%fox', (fox_base_subst)))
