//----------------------------------------------------------------------------//
// This file is part of the Fox project.        
// See the LICENSE.txt file at the root of the project for license information.            
// File : Instructions.def                      
// Author : Pierre van Houtryve                
//----------------------------------------------------------------------------//
// This file uses Macro to "register" every Opcode supported by the Fox VM.
//----------------------------------------------------------------------------//
/*
  Instructions are fixed width and are 32 bits wide. They are pretty similar
  to LuaJIT's instructions. The Opcode always occupies the first 8 bits
  of the instruction. The rest of the instruction can then be split in 2 ways
  depending on the opcode:
      - Divided in 3 8 bits chunk (A B C)
      - Divided in 1 8 bits chunk and another 16 bits chunk.  (A D)

  32    24   16     8      0
  |  C  |  B  |  A  |  OP  |
  |     D     |  A  |  OP  |

  Some instructions may not use any operand at all. Such operations
  are called "Simple" operations.

  TL;DR: 4 instruction kind (for now)
    - Simple: Just the opcode, no args.
    - AB: Opcode + 2 Byte-sized operands (2 x 8 bits). Last 8 bits unused.
    - ABC: Opcode + 3 Byte-sized operands (3 x 8 bits)
    - AD: Opcode + 1 Byte-sized operand and another 2 bytes operand 
          (1 x 8 bits + 1 x 16 bits)

   An important thing to consider is that ops may not use all of their arguments.
   Check the doc of the opcode (if I wrote it by the time you're reading this) to
   know which operands are used.
*/
//----------------------------------------------------------------------------//

#ifndef INSTR
  #define INSTR(ID)
#endif

#ifndef LAST_INSTR
  #define LAST_INSTR(ID)
#endif

#ifndef SIMPLE_INSTR
  #define SIMPLE_INSTR(ID) INSTR(ID)
#endif

#ifndef ABC_INSTR
  #define ABC_INSTR(ID) INSTR(ID)
#endif

#ifndef AB_INSTR
  #define AB_INSTR(ID) INSTR(ID)
#endif

#ifndef AD_INSTR
  #define AD_INSTR(ID) INSTR(ID)
#endif

//----------------------------------------------------------------------------//

SIMPLE_INSTR(NoOp)

ABC_INSTR(AddInt)
ABC_INSTR(AddDouble)

ABC_INSTR(SubInt)
ABC_INSTR(SubDouble)

ABC_INSTR(MulInt)
ABC_INSTR(MulDouble)

ABC_INSTR(DivInt)
ABC_INSTR(DivDouble)

ABC_INSTR(ModInt)
ABC_INSTR(ModDouble)

ABC_INSTR(PowInt)
ABC_INSTR(PowDouble)

AB_INSTR(LNot)


LAST_INSTR(LNot)

//----------------------------------------------------------------------------//

#undef INSTR
#undef SIMPLE_INSTR
#undef ABC_INSTR
#undef AB_INSTR
#undef AD_INSTR
#undef LAST_INSTR